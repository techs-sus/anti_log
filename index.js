import o from"chalk";import e from"clipboardy";import t from"conf";import s from"express";import r from"fs/promises";import a from"localtunnel";import i from"os";import{v4 as c}from"uuid";import n from"vorpal";const l=new n,p=new t({projectName:"anti_log"}),m=i.userInfo().homedir,d=process.cwd()+"/";let u,y,f;async function v(o){(p.get("auto_copy")||o)&&await e.write(`c/NS(game:GetService("HttpService"):GetAsync("${f?.url||"http://localhost:3002"}",false),script);script:Destroy()`)}l.command("clear","Clears terminal.").action((async()=>{console.clear()})),l.command("autocopy <boolean>","Decides if autocopying the url will happen when a new tunnel is made.").action((async o=>{const e=Boolean(o.boolean);p.set("auto_copy",e),l.log(e?"Auto copy set to true.":"Auto copy set to false.")})),l.command("copy","Copy the tun.url to your clipboard. (clipboardy)").action((async()=>{void 0!==f?(v(!0),l.log(f.url)):l.log("You must serve a file first.")})),l.command("stop","Stop serving the file.").action((async()=>{void 0!==f&&(f.close(),l.log("Closed tunnel."),f=void 0),void 0!==y&&(y.close(),l.log("Closed express server."),y=void 0)})),l.command("serve <file>","Serves <file> with protection.").action((async o=>{if(void 0!==y)return void l.log("Please run stop.");const e=o.file.replace("~",m).replace("./",d);u=s();let t=!0;u.get("/",(async(o,s)=>{if(t){const o=(await r.readFile(e)).toString().split("").map((o=>"\\x"+o.charCodeAt(0).toString(16))).join("");t=!1,s.status(200).send('game:GetService("HttpService"):GetAsync('+(f?.url||"https://localhost:3002")+`);script:Destroy();local _ = NS("${o}", owner.PlayerGui);_.Name='SB_Tusk_Maidenless'`)}else s.status(404).send("no!!!"),setTimeout((async()=>{void 0!==f&&f.close(),t=!0,f=await a({subdomain:c(),port:3002}),v(!1)}),200)})),y=u.listen(3002,(async()=>{f=await a({subdomain:c(),port:3002}),l.log("Tunnel ready!"),v(!1)}))})),l.delimiter(o.magenta(process.cwd().replace(m,"~")+" >")).show();